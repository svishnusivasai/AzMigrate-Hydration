#pragma once

#ifdef INMAGE_DBG
VOID
DumpIoctlInformation(
    PDEVICE_OBJECT DeviceObject, 
    PIRP    Irp
    );
#endif
#define IOCTL_MOUNTDEV_LINK_CREATED_WNET_AND_ABOVE   CTL_CODE(MOUNTDEVCONTROLTYPE, 4, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)
#define IOCTL_MOUNTDEV_LINK_CREATED_WXP_AND_BELOW    CTL_CODE(MOUNTDEVCONTROLTYPE, 4, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define IOCTL_MOUNTDEV_LINK_DELETED_WNET_AND_ABOVE   CTL_CODE(MOUNTDEVCONTROLTYPE, 5, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)
#define IOCTL_MOUNTDEV_LINK_DELETED_WXP_AND_BELOW    CTL_CODE(MOUNTDEVCONTROLTYPE, 5, METHOD_BUFFERED, FILE_ANY_ACCESS)

#define IOCTL_DEVICE_TYPE(IOCTL_CODE)   ((IOCTL_CODE >> 16) & 0x0000FFFF)
#define IOCTL_ACCESS(IOCTL_CODE)        ((IOCTL_CODE >> 14) & 0x00000003)
#define IOCTL_FUNCTION(IOCTL_CODE)      ((IOCTL_CODE >> 2) & 0x00000FFF)
#define IOCTL_METHOD(IOCTL_CODE)        (IOCTL_CODE & 0x00000003)

